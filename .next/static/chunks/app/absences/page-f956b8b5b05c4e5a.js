(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[811],{9287:function(e,t,a){Promise.resolve().then(a.bind(a,2380))},2380:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return j}});var s=a(7437),r=a(5654),n=a(5670),i=a(5754),l=a(2265),o=a(6136),c=a(4542),d=a(2381),m=a(6739),f=a(3689),u=a(6062),x=a(2255),h=a(8549),g=a(8971),p=a(4779),y=a(1047),w=a(9397),v=a(1515),b=a.n(v);let _={vacation:"bg-yellow-200 text-yellow-800",sick_leave:"bg-red-200 text-red-800",personal:"bg-blue-200 text-blue-800",conference:"bg-green-200 text-green-800",other:"bg-gray-200 text-gray-800"};function j(){let[e,t]=(0,l.useState)([]),[a,v]=(0,l.useState)([]),[j,N]=(0,l.useState)(()=>(0,m.N)(new Date)),k=(0,f.D)({start:(0,m.N)(j),end:(0,u.V)(j)}),[q,O]=(0,l.useState)({});(0,l.useEffect)(()=>{!function(){let e=(0,m.N)(j);(0,u.V)(j);let t=e.getFullYear(),a=e.getMonth()+1,s=new(b())(t,a),r={};for(let e in s.holidays)for(let t of s.holidays[e]){let e=t.date.greg().toISOString().split("T")[0];r[e]||(r[e]=t.desc[0])}O(r)}()},[j]);let[S,D]=(0,l.useState)(1);(0,l.useEffect)(()=>{let e=e=>{(e.metaKey||e.ctrlKey)&&!e.shiftKey&&("+"===e.key||"="===e.key?(D(e=>Math.min(e+.1,2)),e.preventDefault()):"-"===e.key&&(D(e=>Math.max(e-.1,.5)),e.preventDefault()))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),(0,l.useEffect)(()=>{let e=e=>{(e.metaKey||e.ctrlKey)&&Math.abs(e.deltaY)>0&&(e.deltaY<0?D(e=>Math.min(e+.1,2)):e.deltaY>0&&D(e=>Math.max(e-.1,.5)),e.preventDefault())};return window.addEventListener("wheel",e,{passive:!1}),()=>window.removeEventListener("wheel",e)},[]),(0,l.useEffect)(()=>{(async function(){let[e,a]=await Promise.all([o.Q.getActive(),c.u.getApprovedForRange((0,x.WU)((0,m.N)(j),"yyyy-MM-dd"),(0,x.WU)((0,u.V)(j),"yyyy-MM-dd"))]);t(e),v(a)})()},[j]);let M=(e,t)=>a.find(a=>a.doctor_id===e&&new Date(a.request_start_date)<=t&&new Date(a.request_end_date)>=t),z=e=>{let t=e.getDay();return 5===t||6===t};return(0,s.jsxs)(i.Hn,{children:[(0,s.jsx)(r.S,{variant:"inset"}),(0,s.jsxs)(i.kV,{children:[(0,s.jsx)(n.H,{}),(0,s.jsx)("div",{className:"flex flex-1 flex-col",children:(0,s.jsx)("div",{className:"@container/main flex flex-1 flex-col gap-2",children:(0,s.jsxs)("div",{className:"flex flex-col gap-4 py-4 md:gap-6 md:py-6",children:[(0,s.jsxs)("div",{className:"px-4 lg:px-6 flex items-center justify-between mb-4",children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold flex items-center gap-2",children:["Absence Report",(0,s.jsxs)("span",{className:"text-base font-normal text-gray-500",children:["(",(0,x.WU)(j,"MMMM yyyy"),")"]})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:Object.entries(_).map(e=>{let[t,a]=e;return(0,s.jsx)("span",{className:"inline-block px-2 py-1 rounded text-xs font-semibold ".concat(a),children:t.replace("_"," ")},t)})}),(0,s.jsxs)("div",{className:"flex flex-col gap-1 items-end",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(d.z,{variant:"outline",size:"sm",onClick:()=>N((0,h.W)(j,1)),children:"Previous"}),(0,s.jsx)(d.z,{variant:"outline",size:"sm",onClick:()=>N((0,g.z)(j,1)),children:"Next"})]}),(0,s.jsxs)("div",{className:"flex gap-1 mt-2",children:[(0,s.jsx)(d.z,{variant:"ghost",size:"icon","aria-label":"Zoom out",onClick:()=>D(e=>Math.max(e-.1,.5)),children:(0,s.jsx)(y.Z,{className:"w-4 h-4"})}),(0,s.jsx)(d.z,{variant:"ghost",size:"icon","aria-label":"Zoom in",onClick:()=>D(e=>Math.min(e+.1,2)),children:(0,s.jsx)(w.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)("span",{className:"text-xs text-gray-400 mt-1",children:["Zoom: ",(100*S).toFixed(0),"% (Cmd/Ctrl + / -)"]})]})]}),(0,s.jsx)("div",{className:"px-4 lg:px-6 overflow-x-auto",children:(0,s.jsx)("div",{className:"w-full max-w-full",children:(0,s.jsxs)("div",{className:"grid w-full",style:{gridTemplateColumns:"minmax(90px,1.2fr) repeat(".concat(k.length,", minmax(0,1fr))"),width:"100%",minWidth:"".concat(40*k.length+120,"px"),transform:"scale(".concat(S,")"),transformOrigin:"left top",transition:"transform 0.2s"},children:[(0,s.jsx)("div",{className:"p-2 border-b bg-gray-50 font-medium sticky left-0 top-0 z-30 flex items-center text-xs md:text-sm shadow",style:{minWidth:0,wordBreak:"break-word"},children:"Doctor"}),k.map((e,t)=>{let a=q[e.toISOString().split("T")[0]],r=(0,p.z)(e)?"rgba(56, 189, 248, 0.15)":a?"rgba(255, 193, 7, 0.18)":z(e)?"rgba(243, 244, 246, 1)":"rgba(249, 250, 251, 1)";return(0,s.jsxs)("div",{className:"p-2 border-b text-center font-medium sticky top-0 z-20 text-xs md:text-sm shadow",style:{minWidth:0,background:r},title:a||void 0,children:[(0,x.WU)(e,"d"),6===e.getDay()&&(0,s.jsx)("span",{title:"Shabbat",className:"ml-1",role:"img","aria-label":"Shabbat candle",children:"\uD83D\uDD6Fï¸"})]},e.toISOString())}),e.map((e,t)=>[(0,s.jsx)("div",{className:"p-2 border-b bg-gray-50 font-medium sticky left-0 z-20 flex items-center text-xs md:text-sm shadow",style:{minWidth:0,wordBreak:"break-word",top:0===t?38:void 0},children:e.name},e.id+"-name"),...k.map((t,a)=>{let r;let n=M(e.id,t),i=z(t),l=(0,p.z)(t),o=q[t.toISOString().split("T")[0]];return n&&(i||o)?r=o?"rgba(255, 193, 7, 0.18)":"rgba(243,244,246,0.5)":n?r=void 0:l?r="rgba(56, 189, 248, 0.15)":o?r="rgba(255, 193, 7, 0.18)":i&&(r="rgba(243, 244, 246, 1)"),(0,s.jsx)("div",{className:"p-1 border-b text-center flex items-center justify-center ".concat(n?_[n.type]:""," text-xs md:text-sm"),style:{minWidth:0,background:r},children:n?(0,s.jsx)("span",{className:"sr-only",children:n.type.replace("_"," ")}):""},e.id+"-"+t.toISOString())})])]})})})]})})})]})]})}},6136:function(e,t,a){"use strict";a.d(t,{Q:function(){return r}});var s=a(5526);let r={async getAll(){let{data:e,error:t}=await s.O.from("doctors").select("*").order("name");if(t)throw t;return e},async getActive(){let{data:e,error:t}=await s.O.from("doctors").select("*").eq("is_active",!0).order("name");if(t)throw t;return e},async getById(e){let{data:t,error:a}=await s.O.from("doctors").select("*").eq("id",e).single();if(a)throw a;return t},async create(e){let{data:t,error:a}=await s.O.from("doctors").insert(e).select().single();if(a)throw a;return t},async update(e,t){let{data:a,error:r}=await s.O.from("doctors").update(t).eq("id",e).select().single();if(r)throw r;return a},async softDelete(e){let{data:t,error:a}=await s.O.from("doctors").update({is_active:!1}).eq("id",e).select().single();if(a)throw a;return t},async delete(e){let{error:t}=await s.O.from("doctors").delete().eq("id",e);if(t)throw t;return{success:!0}},async getBySpecialty(e){let{data:t,error:a}=await s.O.from("doctors").select("*").eq("specialty",e).eq("is_active",!0).order("name");if(a)throw a;return t},async search(e){let{data:t,error:a}=await s.O.from("doctors").select("*").or("name.ilike.%".concat(e,"%,employee_id.ilike.%").concat(e,"%,specialty.ilike.%").concat(e,"%")).eq("is_active",!0).order("name");if(a)throw a;return t}}},4542:function(e,t,a){"use strict";a.d(t,{u:function(){return r}});var s=a(5526);let r={async create(e){let{data:t,error:a}=await s.O.from("time_off_requests").insert([{...e,status:"pending"}]).select().single();if(a)throw a;return t},async getAll(){let{data:e,error:t}=await s.O.from("time_off_requests").select("*, doctors(name)").order("request_start_date",{ascending:!1});if(t)throw t;return e||[]},async updateStatus(e,t){let{data:a,error:r}=await s.O.from("time_off_requests").update({status:t}).eq("id",e).select().single();if(r)throw r;return a},async getApprovedForDate(e){let{data:t,error:a}=await s.O.from("time_off_requests").select("*").eq("status","approved").lte("request_start_date",e).gte("request_end_date",e);if(a)throw a;return t||[]},async getApprovedForRange(e,t){let{data:a,error:r}=await s.O.from("time_off_requests").select("*").eq("status","approved").or("and(request_start_date.lte.".concat(t,",request_end_date.gte.").concat(e,")"));if(r)throw r;return a||[]}}}},function(e){e.O(0,[757,972,334,255,607,878,971,117,744],function(){return e(e.s=9287)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[558],{5248:function(e,s,r){Promise.resolve().then(r.bind(r,8974))},8974:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return N}});var t=r(7437),a=r(5654),o=r(5670),i=r(5754),l=r(2381),n=r(279),c=r(9820),d=r(9174),m=r(1032),u=r(5060),x=r(5291),h=r(6367),p=r(3675),g=r(9397),f=r(8420);let j=(0,r(9205).Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);var v=r(3741),y=r(2265);let b=["General Surgery","Cardiac Surgery","Neurology","Orthopedics","Emergency Surgery","Pediatric Surgery","Robotic Surgery","Other"];function N(){let[e,s]=(0,y.useState)([]),[r,N]=(0,y.useState)(""),[_,w]=(0,y.useState)(!0),[C,S]=(0,y.useState)(!1),[k,O]=(0,y.useState)(null),[E,F]=(0,y.useState)(!1),[A,R]=(0,y.useState)(!1),[q,L]=(0,y.useState)({room_number:"",location:"",specialty:"",notes:"",is_active:!0}),[I,P]=(0,y.useState)({room_number:"",location:"",specialty:"",notes:"",is_active:!0}),[D,z]=(0,y.useState)(!1),[B,Z]=(0,y.useState)({});(0,y.useEffect)(()=>{!async function(){w(!0);try{console.log("Page: Starting to fetch operating rooms...");let e=await v.k.getAll();console.log("Page: Operating rooms data received:",e),s(e||[])}catch(e){console.error("Page: Error fetching operating rooms:",e),s([])}w(!1)}()},[]);let M=e.filter(e=>{let s=r.toLowerCase();return e.room_number.toLowerCase().includes(s)||e.location&&e.location.toLowerCase().includes(s)||e.specialty&&e.specialty.toLowerCase().includes(s)}),T=e=>{O(e),F(!0),R(!1)},U=()=>{k&&(L({room_number:k.room_number,location:k.location||"",specialty:k.specialty||"",notes:k.notes||"",is_active:k.is_active}),R(!0))},Q=async()=>{if(k&&confirm("Are you sure you want to delete ".concat(k.room_number,"? This action cannot be undone."))){z(!0);try{await v.k.delete(k.id),s(e=>e.filter(e=>e.id!==k.id)),F(!1),O(null),R(!1),alert("Operating room deleted successfully!")}catch(e){console.error("Error deleting room:",e),alert("Error deleting room: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{z(!1)}}},V=(e,s)=>{L(r=>({...r,[e]:s}))},X=(s,r)=>{B[s]&&Z(e=>{let r={...e};return delete r[s],r}),P(e=>({...e,[s]:r})),"room_number"===s&&"string"==typeof r&&e.find(e=>e.room_number.toLowerCase()===r.toLowerCase())&&Z(e=>({...e,room_number:"This room number is already registered"}))},G=async r=>{r.preventDefault(),z(!0);try{if(!q.room_number)throw Error("Please fill in all required fields");if(e.find(e=>e.id!==k.id&&e.room_number.toLowerCase()===q.room_number.toLowerCase()))throw Error('A room with number "'.concat(q.room_number,'" already exists'));let r=await v.k.update(k.id,{room_number:q.room_number,location:q.location,specialty:q.specialty,notes:q.notes,is_active:q.is_active});s(e=>e.map(e=>e.id===k.id?r:e)),O(r),R(!1),alert("Operating room updated successfully!")}catch(e){console.error("Error updating room:",e),alert("Error updating room: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{z(!1)}},H=async r=>{r.preventDefault(),z(!0);try{if(!I.room_number)throw Error("Please fill in all required fields");if(e.find(e=>e.room_number.toLowerCase()===I.room_number.toLowerCase()))throw Error('A room with number "'.concat(I.room_number,'" already exists'));let r=await v.k.create({room_number:I.room_number,location:I.location,specialty:I.specialty,notes:I.notes,is_active:I.is_active});s(e=>[...e,r]),P({room_number:"",location:"",specialty:"",notes:"",is_active:!0}),S(!1),alert("Operating room added successfully!")}catch(e){console.error("Error creating room:",e),alert("Error creating room: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{z(!1)}};return(0,t.jsxs)(i.SidebarProvider,{children:[(0,t.jsx)(a.AppSidebar,{variant:"inset"}),(0,t.jsxs)(i.SidebarInset,{children:[(0,t.jsx)(o.H,{}),(0,t.jsx)("div",{className:"flex flex-1 flex-col",children:(0,t.jsx)("div",{className:"@container/main flex flex-1 flex-col gap-2",children:(0,t.jsx)("div",{className:"flex flex-col gap-4 py-4 md:gap-6 md:py-6",children:(0,t.jsx)("div",{className:"px-4 lg:px-6",children:(0,t.jsxs)("div",{className:"p-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Operating Rooms"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Manage surgical suites and equipment"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(m.yo,{open:C,onOpenChange:S,children:[(0,t.jsx)(m.aM,{asChild:!0,children:(0,t.jsxs)(l.z,{children:[(0,t.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Add Room"]})}),(0,t.jsxs)(m.ue,{className:"w-[400px] sm:w-[540px] overflow-y-auto",children:[(0,t.jsxs)(m.Tu,{children:[(0,t.jsx)(m.bC,{children:"Add New Operating Room"}),(0,t.jsx)(m.Ei,{children:"Fill in the details to add a new operating room to the system."})]}),(0,t.jsxs)("form",{onSubmit:H,className:"space-y-6 mt-6 pb-6",children:[(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,t.jsx)(f.Z,{className:"h-5 w-5"}),"Basic Information"]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{htmlFor:"room_number",children:"Room Number *"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(j,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(n.I,{id:"room_number",value:I.room_number,onChange:e=>X("room_number",e.target.value),placeholder:"OR-101",className:"pl-10 ".concat(B.room_number?"border-red-500":""),required:!0})]}),B.room_number&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:B.room_number})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{htmlFor:"location",children:"Location"}),(0,t.jsx)(n.I,{id:"location",value:I.location,onChange:e=>X("location",e.target.value),placeholder:"Main Building, Floor 2"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{htmlFor:"specialty",children:"Specialty"}),(0,t.jsxs)(x.Ph,{value:I.specialty,onValueChange:e=>X("specialty",e),children:[(0,t.jsx)(x.i4,{children:(0,t.jsx)(x.ki,{placeholder:"Select specialty"})}),(0,t.jsx)(x.Bw,{children:b.map(e=>(0,t.jsx)(x.Ql,{value:e,children:e},e))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{htmlFor:"notes",children:"Notes"}),(0,t.jsx)(p.g,{id:"notes",value:I.notes,onChange:e=>X("notes",e.target.value),placeholder:"Additional notes about the room...",rows:3})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(h.X,{id:"is_active",checked:I.is_active,onCheckedChange:e=>X("is_active",e)}),(0,t.jsx)(u._,{htmlFor:"is_active",children:"Active Room"})]})]})]})}),(0,t.jsxs)(m.FF,{children:[(0,t.jsx)(l.z,{type:"button",variant:"outline",onClick:()=>S(!1),children:"Cancel"}),(0,t.jsx)(l.z,{type:"submit",disabled:D||Object.keys(B).length>0,children:D?"Adding...":"Add Room"})]})]})]})]}),(0,t.jsx)(m.yo,{open:E,onOpenChange:F,children:(0,t.jsx)(m.ue,{className:"w-[400px] sm:w-[600px] overflow-y-auto",children:k&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(m.Tu,{children:[(0,t.jsxs)(m.bC,{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-16 h-16 rounded-full bg-blue-100 text-2xl font-bold text-blue-600",children:(0,t.jsx)(f.Z,{className:"h-8 w-8"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:["#",k.room_number]}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:k.location||"No location specified"})]})]}),(0,t.jsx)(m.Ei,{children:A?"Edit room information":"Detailed information about room ".concat(k.room_number)})]}),A?(0,t.jsx)("form",{id:"edit-room-form",onSubmit:G,className:"space-y-6 mt-6",children:(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,t.jsx)(f.Z,{className:"h-5 w-5"}),"Basic Information"]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{htmlFor:"edit_room_number",children:"Room Number *"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(j,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(n.I,{id:"edit_room_number",value:q.room_number,onChange:e=>V("room_number",e.target.value),placeholder:"OR-101",className:"pl-10",required:!0})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{htmlFor:"edit_location",children:"Location"}),(0,t.jsx)(n.I,{id:"edit_location",value:q.location,onChange:e=>V("location",e.target.value),placeholder:"Main Building, Floor 2"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{htmlFor:"edit_specialty",children:"Specialty"}),(0,t.jsxs)(x.Ph,{value:q.specialty,onValueChange:e=>V("specialty",e),children:[(0,t.jsx)(x.i4,{children:(0,t.jsx)(x.ki,{placeholder:"Select specialty"})}),(0,t.jsx)(x.Bw,{children:b.map(e=>(0,t.jsx)(x.Ql,{value:e,children:e},e))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{htmlFor:"edit_notes",children:"Notes"}),(0,t.jsx)(p.g,{id:"edit_notes",value:q.notes,onChange:e=>V("notes",e.target.value),placeholder:"Additional notes about the room...",rows:3})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(h.X,{id:"edit_is_active",checked:q.is_active,onCheckedChange:e=>V("is_active",e)}),(0,t.jsx)(u._,{htmlFor:"edit_is_active",children:"Active Room"})]})]})]})})}):(0,t.jsxs)("div",{className:"space-y-6 mt-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,t.jsx)(f.Z,{className:"h-5 w-5"}),"Basic Information"]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{className:"text-sm font-medium text-muted-foreground",children:"Room Number"}),(0,t.jsxs)("div",{className:"text-lg font-medium",children:["#",k.room_number]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{className:"text-sm font-medium text-muted-foreground",children:"Location"}),(0,t.jsx)("div",{className:"text-lg font-medium",children:k.location||"Not specified"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{className:"text-sm font-medium text-muted-foreground",children:"Specialty"}),(0,t.jsx)("div",{className:"text-lg font-medium",children:k.specialty||"Not specified"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{className:"text-sm font-medium text-muted-foreground",children:"Status"}),(0,t.jsx)(d.C,{variant:k.is_active?"default":"destructive",children:k.is_active?"Active":"Inactive"})]})]})]}),k.notes&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Notes"}),(0,t.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,t.jsx)("p",{className:"text-sm",children:k.notes})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"System Information"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{className:"text-sm font-medium text-muted-foreground",children:"Room ID"}),(0,t.jsx)("div",{className:"text-sm font-mono bg-gray-100 p-2 rounded",children:k.id})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{className:"text-sm font-medium text-muted-foreground",children:"Created"}),(0,t.jsx)("div",{className:"text-sm",children:new Date(k.created_date).toLocaleDateString()})]})]})]})]}),(0,t.jsx)(m.FF,{className:"mt-6",children:A?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.z,{type:"button",variant:"outline",onClick:()=>{R(!1)},children:"Cancel"}),(0,t.jsx)(l.z,{type:"submit",form:"edit-room-form",disabled:D,children:D?"Updating...":"Update Room"}),(0,t.jsx)(l.z,{type:"button",variant:"destructive",onClick:Q,disabled:D,children:D?"Deleting...":"Delete Room"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.sw,{asChild:!0,children:(0,t.jsx)(l.z,{variant:"outline",children:"Close"})}),(0,t.jsxs)(l.z,{type:"button",variant:"outline",onClick:e=>{e.preventDefault(),e.stopPropagation(),U()},children:[(0,t.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"Edit Room"]})]})})]})})})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,t.jsx)(n.I,{placeholder:"Search rooms by name, number, or equipment...",value:r,onChange:e=>N(e.target.value),className:"max-w-md"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:[M.length," of ",e.length," rooms"]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:_?(0,t.jsx)("div",{children:"Loading..."}):0===M.length?(0,t.jsx)("div",{children:"No operating rooms found."}):M.map(e=>(0,t.jsx)(c.Zb,{className:"hover:shadow-md transition-shadow cursor-pointer aspect-square",onClick:()=>T(e),children:(0,t.jsxs)(c.aY,{className:"p-6 h-full flex flex-col",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-12 h-12 rounded-full bg-blue-100 text-blue-600 mb-4",children:(0,t.jsx)(f.Z,{className:"h-6 w-6"})}),(0,t.jsxs)("div",{className:"text-center flex-1",children:[(0,t.jsxs)("div",{className:"font-semibold text-lg mb-1",children:["#",e.room_number]}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground mb-3",children:e.location||"No location"}),(0,t.jsxs)("div",{className:"flex gap-2 justify-center mb-3",children:[e.specialty&&(0,t.jsx)(d.C,{variant:"secondary",children:e.specialty}),(0,t.jsx)(d.C,{variant:e.is_active?"default":"destructive",children:e.is_active?"Active":"Inactive"})]}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:e.notes?(0,t.jsx)("span",{className:"line-clamp-2",children:e.notes}):(0,t.jsx)("span",{children:"No notes"})})]})]})},e.id))})]})})})})})]})]})}},3675:function(e,s,r){"use strict";r.d(s,{g:function(){return i}});var t=r(7437),a=r(2265),o=r(3448);let i=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("textarea",{className:(0,o.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:s,...a})});i.displayName="Textarea"},3741:function(e,s,r){"use strict";r.d(s,{k:function(){return a}});var t=r(5526);let a={async getAll(){console.log("Fetching operating rooms from Supabase...");let{data:e,error:s}=await t.O.from("operating_rooms").select("*").order("room_number");if(s)throw console.error("Error fetching operating rooms:",s),s;return console.log("Operating rooms fetched successfully:",e),e},async getActive(){let{data:e,error:s}=await t.O.from("operating_rooms").select("*").eq("is_active",!0).order("room_number");if(s)throw s;return e},async getById(e){let{data:s,error:r}=await t.O.from("operating_rooms").select("*").eq("id",e).single();if(r)throw r;return s},async create(e){let{data:s,error:r}=await t.O.from("operating_rooms").insert(e).select().single();if(r)throw r;return s},async update(e,s){let{data:r,error:a}=await t.O.from("operating_rooms").update(s).eq("id",e).select().single();if(a)throw a;return r},async softDelete(e){let{data:s,error:r}=await t.O.from("operating_rooms").update({is_active:!1}).eq("id",e).select().single();if(r)throw r;return s},async delete(e){let{error:s}=await t.O.from("operating_rooms").delete().eq("id",e);if(s)throw s;return{success:!0}},async getBySpecialty(e){let{data:s,error:r}=await t.O.from("operating_rooms").select("*").eq("specialty",e).eq("is_active",!0).order("room_number");if(r)throw r;return s},async search(e){let{data:s,error:r}=await t.O.from("operating_rooms").select("*").or("room_number.ilike.%".concat(e,"%,location.ilike.%").concat(e,"%,specialty.ilike.%").concat(e,"%")).eq("is_active",!0).order("room_number");if(r)throw r;return s}}}},function(e){e.O(0,[972,716,109,654,89,971,117,744],function(){return e(e.s=5248)}),_N_E=e.O()}]);